[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "TROLL V4 Evaluation",
    "section": "",
    "text": "Introduction\nThe aim of these analyses is to evaluate the TROLL version 4 simulations of daily fluxes and the final structure and composition of the forest in relation to field observations and remote sensing at two Amazonian sites."
  },
  {
    "objectID": "index.html#study-sites",
    "href": "index.html#study-sites",
    "title": "TROLL V4 Evaluation",
    "section": "Study sites",
    "text": "Study sites\nWe have four sites with long-term eddy flux tower in Amazonia but we were only able to collect data from 2 in Brazil and 1 in French Guiana with free access. As BR-Sa3 also known as Km83 is in a logged forest on a shorter period and with lower rainfall registered in the flux tower we will focus on GF-Guy, hereafter Paracou, and BR-Sa1, hereafter Tapajos.\n\n\nCode\ntibble(\n  site = c(\"Paracou\", \"Tapajos\"),\n  latitude = c(5.27877, -2.85667),\n  longitude = c(-52.92486, -54.9588900),\n) %&gt;% \n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %&gt;% \n  leaflet() %&gt;% \n  addTiles() %&gt;% \n  addMarkers(label = ~site, labelOptions = labelOptions(noHide = T))"
  },
  {
    "objectID": "index.html#poeple",
    "href": "index.html#poeple",
    "title": "TROLL V4 Evaluation",
    "section": "Poeple",
    "text": "Poeple\n\nSylvain Schmitt (sylvain.schmitt@cirad.fr)\nIsabelle Maréchaux (isabelle.marechaux@inrae.fr)\nJérôme Chave (jerome.chave@univ-tlse3.fr)\nFabian J. Fischer (f.fischer@bristol.ac.uk)\nDamien Bonal (damien.bonal@inrae.fr)\nBenoit Burban(benoit.burban@inrae.fr)\nNicolas Barbier (nicolas.barbier@ird.fr)\nGregoire Vincent (gregoire.vincent@ird.fr)\nPhilippe Verley (philippe.verley@ird.fr)\nJames Ball (jgcb3@cam.ac.uk)?\nGéraldine Derroire (geraldine.derroire@cirad.fr)\nGiacomo Selan (giacomo.sellan@cirad.fr)\nJérémy Lischtein ()?\nDaniela Nemetschek (Daniela.Krebber@ecofog.gf)\nMarion Boisseaux (marionboisseaux@gmail.com)\nCamille Ziegler (camille.ziegler9@gmail.com)"
  },
  {
    "objectID": "10_data.html",
    "href": "10_data.html",
    "title": "Data",
    "section": "",
    "text": "Data used for TROLL evaluation are composed of data used as inputs for TROLL simulations and data used as outputs to assess the simulations. TROLL runs with species parameters, including functional traits and allometric parameters, climate data, and soil data. We evaluated TROLL simulations against forest fluxes and final forest structure and composition. Data include thus forest inventories (species inputs, forest structure and composition evaluation), functional traits (species inputs and forest composition evaluation), soil parameters (soil inputs), climate data (climate input), and fluxes data (forest fluxes evaluation)."
  },
  {
    "objectID": "11_inventories.html#paracou",
    "href": "11_inventories.html#paracou",
    "title": "Inventories",
    "section": "Paracou",
    "text": "Paracou\n\nParacou is a large scale forest disturbance experiment set up by Cirad in 1982 that becomes in time a unique research site for the international scientific community in tropical forest ecology. https://paracou.cirad.fr/website/\n\nPI: Géraldine Derroire\nAccess: DOIs are available on the CIRAD dataverse: https://dataverse.cirad.fr/dataverse/paracou .\n\n\nCode\nread_tsv(\"outputs/inventories.tsv\", show_col_types = FALSE) %&gt;% \n  filter(site == \"Paracou\", type == \"default\") %&gt;% \n  ggplot(aes(x, y, size = dbh, col = species)) +\n  geom_point() +\n  facet_wrap(~ plot) +\n  scale_color_discrete(guide = \"none\") +\n  theme_bw() +\n  theme(axis.title = element_blank()) +\n  scale_size(guide = \"none\", range = c(0.2, 2)) +\n  coord_equal()"
  },
  {
    "objectID": "11_inventories.html#paracou---understory",
    "href": "11_inventories.html#paracou---understory",
    "title": "Inventories",
    "section": "Paracou - Understory",
    "text": "Paracou - Understory\n\nForest plots in French Guiana (Paracou and Nouragues) and inventory and map all trees over one cm in height at the chest, in order to advance knowledge of the ecology and services of the Amazon ecosystem.\n\nPIs: Giacomo Sellan, Gérladine Derroire, Jérôme Chave\nAccess: Upon request?\n\n\nCode\nread_tsv(\"outputs/inventories.tsv\", show_col_types = FALSE) %&gt;% \n  filter(site == \"Paracou\", type == \"understory\") %&gt;% \n  filter(!is.na(x), !is.na(y)) %&gt;% \n  ggplot(aes(x, y, size = dbh, col = species)) +\n  geom_point() +\n  scale_color_discrete(guide = \"none\") +\n  theme_bw() +\n  theme(axis.title = element_blank()) +\n  scale_size(guide = \"none\", range = c(0.2, 2)) +\n  coord_equal()"
  },
  {
    "objectID": "11_inventories.html#tapajos",
    "href": "11_inventories.html#tapajos",
    "title": "Inventories",
    "section": "Tapajos",
    "text": "Tapajos\n\nThis dataset provides tree inventory, tree height, diameter at breast height (DBH), and estimated crown measurements from 30 plots located in the Tapajos National Forest, Para, Brazil collected in September 2010. The plots were located in primary forest, primary forest subject to reduced-impact selective logging (PFL) between 1999 and 2003, and secondary forest (SF) with different age and disturbance histories. Plots were centered on GLAS (the Geoscience Laser Altimeter System) LiDAR instrument footprints selected along two sensor acquisition tracks spanning a wide range in vertical structure and aboveground biomass. https://daac.ornl.gov/VEGETATION/guides/Forest_Inventory_Tapajos.html\n\nAccess: These data are available through the Oak Ridge National Laboratory (ORNL) Distributed Active Archive Center (DAAC).\n\n\nCode\nread_tsv(\"outputs/inventories.tsv\", show_col_types = FALSE) %&gt;% \n  filter(site == \"Tapajos\", type == \"default\") %&gt;% \n  ggplot(aes(x, y, size = dbh, col = species)) +\n  geom_point() +\n  facet_wrap(~ plot) +\n  scale_color_discrete(guide = \"none\") +\n  theme_bw() +\n  theme(axis.title = element_blank()) +\n  scale_size(guide = \"none\", range = c(1, 4)) +\n  coord_equal()"
  },
  {
    "objectID": "11_inventories.html#structure",
    "href": "11_inventories.html#structure",
    "title": "Inventories",
    "section": "Structure",
    "text": "Structure\nForest structure was simply be assessed by DBH (m) classes using basal area (BA, m2/ha) and abundance for each plots (uncertainty bars in Paracou data).\n\n\nCode\nread_tsv(\"outputs/structure.tsv\", show_col_types = FALSE) %&gt;% \n  filter(dbh_class &gt;= 10) %&gt;% \n  group_by(site, type, dbh_class, variable) %&gt;% \n  summarise(l = quantile(observed, 0.025, na.rm = TRUE), \n            m = quantile(observed, 0.5, na.rm = TRUE), \n            h = quantile(observed, 0.975, na.rm = TRUE)) %&gt;% \n  filter(variable %in% c(\"ba\", \"log_abundance\")) %&gt;% \n  ggplot(aes(dbh_class, m, col = site)) +\n  geom_linerange(aes(ymin = l, ymax = h)) +\n  geom_point() +\n  geom_line() +\n  theme_bw() +\n  facet_wrap(~ variable, scales = \"free\") +\n  xlab(\"DBH (cm)\") + ylab(\"\") +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/structure.tsv\", show_col_types = FALSE) %&gt;% \n  filter(dbh_class &lt; 10) %&gt;% \n  group_by(site, type, dbh_class, variable) %&gt;% \n  summarise(l = quantile(observed, 0.025, na.rm = TRUE), \n            m = quantile(observed, 0.5, na.rm = TRUE), \n            h = quantile(observed, 0.975, na.rm = TRUE)) %&gt;% \n  filter(variable %in% c(\"ba\", \"log_abundance\")) %&gt;% \n  ggplot(aes(dbh_class, m, col = site)) +\n  geom_linerange(aes(ymin = l, ymax = h)) +\n  geom_point() +\n  geom_line() +\n  theme_bw() +\n  facet_wrap(~ variable, scales = \"free\") +\n  xlab(\"DBH (cm)\") + ylab(\"\") +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "11_inventories.html#composition",
    "href": "11_inventories.html#composition",
    "title": "Inventories",
    "section": "Composition",
    "text": "Composition\nForest composition was simply assessed using rank abundances curves cut at the number of species simulated in TROLL each plots (uncertainty dotted lines in Paracou data).\n\n\nCode\nread_tsv(\"outputs/composition.tsv\", show_col_types = FALSE) %&gt;% \n  group_by(site, plot, variable) %&gt;% \n  arrange(desc(observed)) %&gt;% \n  mutate(rank = 1:n()) %&gt;% \n  group_by(site, rank, variable) %&gt;% \n  summarise(l = quantile(observed, 0.025, na.rm = TRUE), \n            m = quantile(observed, 0.5, na.rm = TRUE), \n            h = quantile(observed, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(rank, m, col = site)) +\n  geom_line(aes(y = l), linewidth = 0.5, linetype = \"dashed\") +\n  geom_line(aes(y = h), linewidth = 0.5, linetype = \"dashed\") +\n  geom_line() +\n  theme_bw() +\n  xlab(\"Rank\") + ylab(\"Abundance\") +\n  scale_color_discrete(\"\") +\n  theme(legend.position = \"bottom\") +\n  scale_y_log10()"
  },
  {
    "objectID": "12_species.html#allometric-parameters",
    "href": "12_species.html#allometric-parameters",
    "title": "Species",
    "section": "Allometric parameters",
    "text": "Allometric parameters\nWe took advantage of the TALLO database (Jucker et al. 2022) to infer species allometric parameters of the 496 species present in Amazonia (latitude between 10 and -18 and longitude between -78 and -39).\n\n\nCode\nggplot(map_data(\"world\"), aes(x = long, y = lat)) +\n  geom_polygon(aes(group = group), fill=\"lightgray\", colour = \"white\") +\n  geom_point(data = read_csv(\"data/species/tallo.csv\") %&gt;% \n               mutate(amazonia = ifelse(longitude &lt;= -39 & \n                                          longitude &gt;= -79 &\n                                          latitude &gt;= -18 &\n                                          latitude &lt;= 10, \"amazonia\", \"other\")),\n  aes(x = longitude, y = latitude, col = amazonia)) +\n  theme_bw() +\n  geom_hline(yintercept = c(10, -18)) +\n  geom_vline(xintercept = c(-39, -79)) +\n  theme(axis.title = element_blank(), legend.position = \"bottom\") +\n  scale_color_manual(\"\", values = c(\"darkgreen\", \"black\")) +\n  coord_equal()\n\n\n\n\n\n\n\nCode\nread_csv(\"data/species/tallo.csv\") %&gt;% \n  filter(longitude &lt;= -39, longitude &gt;= -79, latitude &gt;= -18, latitude &lt;= 10) %&gt;% \n  ggplot(aes(stem_diameter_cm, height_m)) +\n  geom_point(aes(col = species), alpha = 0.25) +\n  theme_bw() +\n  geom_smooth() +\n  scale_color_discrete(guide = \"none\") +\n  xlab(\"diameter (cm)\") + ylab(\"height (m)\")\n\n\n\n\n\nWe inferred the following allometry using brms:\n\\[\n\\begin{array}{c}\nlog(height) \\sim N [ log(h_{max,s} \\times \\frac{dbh}{a_{h,s}+dbh^2}), \\sigma^2] \\\\\nh_{max,s} \\sim N (h_{max}, \\sigma_h^2) \\\\\na_{h,s} \\sim N (a_{h}, \\sigma_a^2)\n\\end{array}\n\\]\n\n\nCode\nlibrary(brms)\nmdata &lt;- read_csv(\"data/species/tallo.csv\") %&gt;% \n  filter(longitude &lt;= -39, longitude &gt;= -79, latitude &gt;= -18, latitude &lt;= 10) %&gt;% \n  select(species, height_m, stem_diameter_cm) %&gt;% \n  rename(h = height_m, d = stem_diameter_cm) %&gt;% \n  mutate(d = d/100) %&gt;% \n  mutate(species = ifelse(is.na(species), \"unknown\", species))\nfit &lt;- brm(bf(log(h) ~ log(hmax * (d/ (ah + d))), \n              hmax ~ 1 + 1|species,\n              ah ~ 1 + 1|species,\n              nl = TRUE), \n           prior = c(\n             prior(normal(40, 10), lb = 10, nlpar = \"hmax\"),\n             prior(normal(0.5, 0.5), lb = 0, nlpar = \"ah\")\n             ),\n           data = mdata, chains = 2, cores = 2, threads = 10)\nsave(fit, file = \"outputs/brms_tallo.Rdata\")\nfit %&gt;% \n  tidybayes::spread_draws(b_hmax_Intercept, r_species__hmax[species,],\n               b_ah_Intercept, r_species__ah[species,]) %&gt;% \n  mutate(ah = b_ah_Intercept + r_species__ah) %&gt;% \n  mutate(hmax = b_hmax_Intercept + r_species__hmax) %&gt;% \n  group_by(species) %&gt;% \n  summarise(ah = median(ah), hmax = median(hmax)) %&gt;% \n  filter(species != \"unknown\") %&gt;% \n  mutate(species = gsub(\".\", \" \", species, fixed = TRUE)) %&gt;% \n  left_join(read_csv(\"data/species/tallo.csv\") %&gt;% \n  filter(longitude &lt;= -39, longitude &gt;= -79, latitude &gt;= -18, latitude &lt;= 10) %&gt;% \n    select(family, genus, species) %&gt;% unique()) %&gt;% \n  write_tsv(\"outputs/tallo_pars.tsv\")\n\n\nWe had good convergence and good post-predictive checks.\n\n\nCode\nload('outputs/brms_tallo.Rdata')\nbayesplot::mcmc_rhat(bayesplot::rhat(fit$fit))\n\n\n\n\n\n\n\nCode\nload('outputs/brms_tallo.Rdata')\nbayesplot::pp_check(fit)\n\n\n\n\n\nWe thus inferred 496 additional \\(a_h\\), \\(h_{max}\\) couple of parameters.\n\n\nCode\nload('outputs/brms_tallo.Rdata')\nsjPlot::tab_model(fit)\n\n\n\n\n\n \nlog(h)\n\n\nPredictors\nEstimates\nCI (95%)\n\n\nhmax_Intercept\n40.52\n38.69 – 42.38\n\n\nah_Intercept\n0.29\n0.27 – 0.31\n\n\nObservations\n24609\n\n\nR2 Bayes\n0.742\n\n\n\n\n\n\n\n\n\nCode\nfit %&gt;% \n  tidybayes::spread_draws(b_hmax_Intercept, r_species__hmax[species,],\n               b_ah_Intercept, r_species__ah[species,]) %&gt;% \n  mutate(ah = b_ah_Intercept + r_species__ah) %&gt;% \n  mutate(hmax = b_hmax_Intercept + r_species__hmax) %&gt;% \n  group_by(species) %&gt;% \n  summarise(ah = median(ah), hmax = median(hmax)) %&gt;%\n  filter(species != \"unknown\") %&gt;% \n  ggplot(aes(ah, hmax)) +\n  geom_point() +\n  theme_bw() +\n  xlab(expression(a[h])) + ylab(expression(h[max]))"
  },
  {
    "objectID": "12_species.html#functional-traits",
    "href": "12_species.html#functional-traits",
    "title": "Species",
    "section": "Functional traits",
    "text": "Functional traits\nWe further combined the obtained coefficient from TALLO with the following datasets:\n\nJucker et al. (2022)\nMaréchaux et al. (2015)\nGuillemot et al. (2022)\nVleminckx et al. (2021)\nTROLL version 4 species data\nTapajos functional traits data retrieved by Jérôme Chave (pers. com.) from the TRY database (Kattge, Bönisch, and al. 2020)\n\nTROLL version 4 species data were gathered from:\n\nTROLL version 3 species (partly from Baraloto et al. (2010), described in Maréchaux and Chave (2017), and available in @schmitt2023 and )\nMaréchaux et al. (2015)\nMaréchaux et al. (2019)\nNemetschek et al. (2024)\nSchmitt and Boisseaux (2023)\nBoisseaux et al. submitted\nZiegler et al. (which?)\n\nAll databases together included 20 traits across 2,921 species but with numerous missing data. Traits distribution were similar across datasets. However, for the same species, allometric parameters inferred from TALLO were lower than those inside TROLL V4 and leaf area from Guillemot was higher than those from TROLL and Vleminckx. As all Paracou TROLL species are in Vleminckx dataset and 109 species from Tapajos we will use only the species from Vleminckx to limit missing data in predictive mean matching (PMM) data imputation.\n\n\nCode\n# Maréchaux et al., (2015)\nmarechaux &lt;- readxl::read_xls(\"data/species/marechaux.xls\", \"data\") %&gt;% \n  mutate(Pi_tlp = as.numeric(Pi_tlp)) %&gt;% \n  separate(Binomial, c(\"genus\", \"species\"), remove = FALSE) %&gt;% \n  mutate(species = gsub(\"_\", \" \", Binomial)) %&gt;% \n  rename(family = Family, TLP = Pi_tlp) %&gt;% \n  dplyr::select(family, genus, species, TLP) %&gt;% \n  mutate(dataset = \"Maréchaux 2015\") %&gt;% \n  gather(trait, value, -dataset, -family, -genus, -species)\n# Jucker et al., (2022) inferred\ntallo &lt;- read_tsv(\"outputs/tallo_pars.tsv\") %&gt;% \n  mutate(dataset = \"Tallo inferred\") %&gt;% \n  gather(trait, value, -dataset, -family, -genus, -species)\n# Vleminckx et al., (2021)\nvleminckx &lt;- readxl::read_xlsx(\"data/species/vleminckx.xlsx\",\n                  \"App.S6-ok\", skip = 3) %&gt;% \n  mutate(species = sub(\"_\", \" \", Species)) %&gt;% \n  mutate(species = gsub(\"[[:punct:]]\", \"\", species)) %&gt;% \n  rename(family = Family, genus = Genus, CC = Chlorophyll_content,\n         LT = Thickness, LA = Leaf_Area, d13C = `13C`,\n         BT = Trunk_bark_thickness) %&gt;% \n    mutate(N = N/100, P = P/10^6, LMA = 1/SLA*1000) %&gt;% \n  mutate(LMA = ifelse(LMA &gt; 200, NA, LMA)) %&gt;% \n  dplyr::select(family, genus, species, CC, LT, \n                Toughness, LA, LMA, C, N, d13C, Ca, P, K, \n                BT, WSG, SRL, SRTA) %&gt;% \n   mutate(dataset = \"Vleminckx 2021\") %&gt;% \n  gather(trait, value, -dataset, -family, -genus, -species)\n# Guillemot et al., (2022)\nguillemot &lt;- readxl::read_xlsx(\"data/species/guillemot.xlsx\", \"Dataset\") %&gt;% \n  mutate(max_height = as.numeric(gsub(',', '.', max_height))) %&gt;% \n  rename(LA = leaf_size, N = Leaf_N, P = Leaf_P, \n         WSG = Wood_density, hmax = max_height) %&gt;% \n  mutate(TLP = ifelse(TLP &lt; -3, NA, TLP)) %&gt;% \n  mutate(P50 = ifelse(P50 &lt; -10, NA, P50)) %&gt;% \n  mutate(LA = ifelse(LA &gt; 1000, NA, LA)) %&gt;% \n  mutate(LMA = ifelse(LMA &gt; 200, NA, LMA)) %&gt;% \n  select(family, genus, species, TLP, P50, LMA, LA, WSG) %&gt;% \n  mutate(dataset = \"Guillemot 2022\") %&gt;% \n  gather(trait, value, -dataset, -family, -genus, -species)\n# TROLL V4\ntroll &lt;- rcontroll::TROLLv4_species %&gt;% \n  rename_all(~ gsub(\"s_\", \"\", .)) %&gt;% \n  rename(species = name, N =Nmass, P = Pmass,\n         WSG = wsg, TLP = tlp, LA = leafarea) %&gt;% \n   mutate(species = gsub(\"_\", \" \", species)) %&gt;% \n  select(-seedmass, -regionalfreq) %&gt;% \n  left_join(select(vleminckx, family, genus, species) %&gt;% unique()) %&gt;% \n  mutate(dataset = \"TROLL V4\") %&gt;% \n  gather(trait, value, -dataset, -family, -genus, -species)\n# Tapajos\ntapajos &lt;- vroom::vroom(\"data/species/tapajos_try.csv\") %&gt;% \n  separate(species, c(\"genus\", \"Species\"), remove = FALSE) %&gt;% \n  mutate(family = BIOMASS::getTaxonomy(genus, findOrder = FALSE)$family)  %&gt;% \n  filter(!is.na(Species)) %&gt;% \n  filter(!is.na(family)) %&gt;% \n  mutate(LMA = 1/SLA*1000, N = `N_try(mg/g)`/1000, WSG = wood_density,\n         P = `P_try(mg/g)`/1000, dbhmax = dbh_max/100) %&gt;% \n  select(family, genus, species, LMA, N, P, WSG, dbhmax) %&gt;% \n  mutate(dataset = \"Tapajos TRY\") %&gt;% \n  gather(trait, value, -dataset, -family, -genus, -species)\n# All\nraw &lt;- bind_rows(marechaux, \n                 tallo,\n                 vleminckx, \n                 guillemot, \n                 troll,\n                 tapajos) %&gt;% \n  na.omit()  \nfiltered &lt;- raw %&gt;% \n  filter(species %in% vleminckx$species) %&gt;% \n  group_by(family, genus, species, dataset, trait) %&gt;% \n  summarise(value = median(value)) %&gt;% \n  group_by(family, genus, species, trait) %&gt;% \n  summarise(value = median(value)) %&gt;% \n  pivot_wider(names_from = trait, values_from = value) %&gt;% \n  ungroup()\n\n\n\n\nCode\nfiltered %&gt;% \n  select(-family, -genus) %&gt;% \n  gather(trait, value, -species) %&gt;% \n  na.omit() %&gt;% \n  group_by(trait) %&gt;% \n  summarise(N = n()) %&gt;% \n  knitr::kable()\n\n\n\n\n\ntrait\nN\n\n\n\n\nBT\n2043\n\n\nC\n2043\n\n\nCC\n2043\n\n\nCa\n2043\n\n\nK\n2043\n\n\nLA\n2057\n\n\nLMA\n2028\n\n\nLT\n2043\n\n\nN\n2044\n\n\nP\n2044\n\n\nP50\n43\n\n\nSRL\n2043\n\n\nSRTA\n2043\n\n\nTLP\n125\n\n\nToughness\n2043\n\n\nWSG\n2053\n\n\nah\n252\n\n\nd13C\n2043\n\n\ndbhmax\n192\n\n\nhmax\n252\n\n\n\n\n\n\n\nCode\noptions(knitr.kable.NA = '')\nraw %&gt;% \n  group_by(species, dataset) %&gt;% \n  summarise(value = 1) %&gt;% \n  pivot_wider(names_from = dataset, values_from = value) %&gt;% \n  mutate(`Vleminckx 2021` = ifelse(is.na(`Vleminckx 2021`), \"Vleminckx: no\", \"Vleminckx: yes\")) %&gt;% \n  ungroup() %&gt;% \n  select(-species) %&gt;% \n  gather(dataset, value, -`Vleminckx 2021`) %&gt;% \n  na.omit() %&gt;% \n  group_by(`Vleminckx 2021`, dataset) %&gt;% \n  summarise(N = n()) %&gt;% \n  pivot_wider(names_from = `Vleminckx 2021`, values_from = N) %&gt;% \n  knitr::kable()\n\n\n\n\n\ndataset\nVleminckx: no\nVleminckx: yes\n\n\n\n\nGuillemot 2022\n538\n57\n\n\nMaréchaux 2015\n9\n62\n\n\nTallo inferred\n302\n193\n\n\nTapajos TRY\n85\n109\n\n\nTROLL V4\n\n107\n\n\n\n\n\n\n\nCode\nraw %&gt;% \n  mutate(trait = gsub(\"_\", \" \", trait)) %&gt;% \n  ggplot(aes(dataset, value, col = dataset)) +\n  geom_boxplot() +\n  facet_wrap(~ trait, scales = \"free\") +\n  theme_bw() +\n  theme(axis.title = element_blank(), axis.text.x = element_blank(),\n        legend.position = \"bottom\") \n\n\n\n\n\n\n\nCode\nraw %&gt;% \n  select(species, dataset, trait, value) %&gt;% \n  group_by(species, dataset, trait) %&gt;% \n  summarise(value = median(value)) %&gt;% \n  group_by(species, trait) %&gt;%\n  filter(n() &gt; 1) %&gt;%\n  mutate(median = median(value, na.rm = TRUE)) %&gt;% \n  ggplot(aes(median, value, col = dataset)) +\n  geom_point() +\n  facet_wrap(~ trait, scales = \"free\") +\n  theme_bw() +\n  geom_smooth(method = \"lm\", se = FALSE)\n\n\n\n\n\n\n\nCode\nfiltered %&gt;% \n  select(-family, -genus, -species) %&gt;% \n  cor(use = \"pairwise.complete.obs\") %&gt;% \n  corrplot::corrplot(type = \"upper\", diag = FALSE)"
  },
  {
    "objectID": "12_species.html#imputation",
    "href": "12_species.html#imputation",
    "title": "Species",
    "section": "Imputation",
    "text": "Imputation\nMissing data were too important to use random forest for imputation with missForest even with phylogenetic eigen values. Thus, I used simple predictive mean matching (PMM) data imputation with mice without phylogenetic eigen values. However, phylogenetic eigen values could also been used with phylomice (not done here). As we focused on species in common with Vlemincks data we only had to impute ah, dbhmax, hmax and TLP with values from Maréchaux, Tapajos and inferred with TALLO. Obtained imputed distributions matched well the observed distribution of the raw data and imputed functional space match the one of the raw data (PCA). The PCA also revealed similar functional spaces between species from Paracou and Tapajos, whereas Tapajos functional space is a bit wider.\n\n\nCode\nimputation &lt;- filtered %&gt;% \n  mice::mice(maxit = 100)\ncomplete(imputation) %&gt;% \n  gather(trait, value, -family, -genus, -species) %&gt;% \n  mutate(type = \"imputed\") %&gt;% \n  bind_rows(gather(filtered, trait, value, -family, -genus, -species) %&gt;% \n              mutate(type = \"raw\")) %&gt;% \n  na.omit() %&gt;% \n  write_tsv(\"outputs/imputation.tsv\")\n\n\n\n\nCode\nvroom::vroom(\"outputs/imputation.tsv\") %&gt;% \n  filter(trait %in% troll$trait) %&gt;% \n  ggplot(aes(value, col = type)) +\n  geom_density() +\n  theme_bw() +\n  facet_wrap(~ trait, scales = \"free\")\n\n\n\n\n\n\n\nCode\ndata &lt;- vroom::vroom(\"outputs/imputation.tsv\") %&gt;% \n  filter(trait %in% troll$trait) %&gt;% \n  pivot_wider(names_from = trait, values_from = value) %&gt;% \n  na.omit()\nautoplot(princomp(select(data, -family, -genus, -species, -type), cor = TRUE), \n         data = data, alpha = 0.25, col = \"type\",\n         loadings.label.size = 6,\n         loadings.label.colour = 'red', loadings.label.vjust = 1.1,\n         loadings.label.repel   = TRUE,\n         loadings = T, loadings.label = T, loadings.colour = 'red') +\n  coord_equal() +\n  geom_hline(aes(yintercept = 0), col = 'black', linetype = \"dotted\") +\n  geom_vline(aes(xintercept = 0), col = 'black', linetype = \"dotted\") +\n  theme_bw()\n\n\n\n\n\n\n\nCode\ndata2 &lt;- data %&gt;% \n  filter(type == \"imputed\") %&gt;% \n  mutate(tapajos = (species %in% tapajos$species)) %&gt;% \n  mutate(paracou = (species %in% troll$species)) %&gt;% \n  filter(tapajos | paracou) %&gt;% \n  mutate(forest = ifelse(tapajos, \"tapajos\", \"paracou\")) %&gt;% \n  mutate(forest = ifelse(paracou & tapajos, \"both\", forest)) %&gt;% \n  select(-tapajos, -paracou, -type)\nautoplot(princomp(select(data2, -family, -genus, -species, -forest), cor = TRUE), \n         data = data2, alpha = 0.5, col = \"forest\",\n         loadings.label.size = 6,\n         loadings.label.colour = 'red', loadings.label.vjust = 1.1,\n         loadings.label.repel   = TRUE,\n         loadings = T, loadings.label = T, loadings.colour = 'red') +\n  coord_equal() +\n  geom_hline(aes(yintercept = 0), col = 'black', linetype = \"dotted\") +\n  geom_vline(aes(xintercept = 0), col = 'black', linetype = \"dotted\") +\n  theme_bw() +\n  stat_ellipse(aes(col = forest))\n\n\n\n\n\n\n\nCode\ndata2 %&gt;% \n  filter(forest != \"paracou\") %&gt;% \n  select(-forest, -family, -genus) %&gt;% \n  mutate(seedmass = 1, regionalfreq = 1/n()) %&gt;% \n  mutate(species = gsub(\" \", \"_\", species)) %&gt;% \n  rename(s_name = species, s_LMA = LMA, s_Nmass = N, s_Pmass = P, s_wsg = WSG,\n         s_dbhmax = dbhmax, s_hmax = hmax, s_ah = ah, \n         s_seedmass = seedmass, s_regionalfreq = regionalfreq, \n         s_tlp = TLP, s_leafaera = LA) %&gt;% \n  write_tsv(\"outputs/tapajos_species_troll.tsv\")\ndata2 %&gt;% \n  filter(forest != \"tapajos\") %&gt;% \n  select(-forest, -family, -genus) %&gt;% \n  mutate(seedmass = 1, regionalfreq = 1/n()) %&gt;% \n  mutate(species = gsub(\" \", \"_\", species)) %&gt;% \n  rename(s_name = species, s_LMA = LMA, s_Nmass = N, s_Pmass = P, s_wsg = WSG,\n         s_dbhmax = dbhmax, s_hmax = hmax, s_ah = ah, \n         s_seedmass = seedmass, s_regionalfreq = regionalfreq, \n         s_tlp = TLP, s_leafaera = LA) %&gt;% \n  write_tsv(\"outputs/paracou_species_troll.tsv\")"
  },
  {
    "objectID": "12_species.html#functional-composition",
    "href": "12_species.html#functional-composition",
    "title": "Species",
    "section": "Functional composition",
    "text": "Functional composition\nForest functional composition was simply assessed using functional trait distribution in each plots (repeted lines in Paracou data) at the species level in Paracou and genus level in Tapajos.\n\n\nCode\ntraits &lt;- bind_rows(read_tsv(\"outputs/tapajos_species_troll.tsv\"),\n          read_tsv(\"outputs/paracou_species_troll.tsv\")) %&gt;% \n  unique() %&gt;% \n  rename_all(~ gsub(\"s_\", \"\", .)) %&gt;% \n  select(-seedmass, -regionalfreq) %&gt;% \n  rename(species = name) %&gt;% \n  mutate(species = gsub(\"_\", \" \", species)) %&gt;% \n  gather(trait, trait_value, -species)\nparacou &lt;- read_tsv(\"outputs/inventories.tsv\") %&gt;% \n  filter(site == \"Paracou\", type == \"default\") %&gt;% \n  mutate(plot = ifelse(site == \"Tapajos\", 1, plot)) %&gt;% \n  filter(type == \"default\") %&gt;% \n  select(site, plot, species) %&gt;% \n  left_join(traits) %&gt;% \n  na.omit()\ntapajos &lt;- read_tsv(\"outputs/inventories.tsv\") %&gt;% \n  filter(site == \"Tapajos\", type == \"default\") %&gt;% \n  mutate(site = \"Tapajos\", plot = 1) %&gt;% \n  separate(species, \"species\") %&gt;% \n  select(plot, site, species) %&gt;% \n      left_join(traits %&gt;% \n  separate(species, \"species\") %&gt;% \n  group_by(species, trait) %&gt;% \n  summarise_all(mean)) %&gt;% \n  na.omit()\nbind_rows(paracou, tapajos) %&gt;% \n  write_tsv(\"outputs/functional_composition.tsv\")\n\n\n\n\nCode\nread_tsv(\"outputs/functional_composition.tsv\") %&gt;% \n  filter(site == \"Paracou\") %&gt;% \n  ggplot(aes(trait_value, group = plot)) +\n  geom_density(alpha = 0.5) +\n  facet_wrap(~ trait, scales = \"free\") +\n  theme_bw() +\n  ggtitle(\"Paracou\", \"546,498 inds represented on 577,761 (94.59%)\") +\n  theme(axis.title = element_blank(), legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/functional_composition.tsv\") %&gt;% \n  filter(site == \"Tapajos\") %&gt;% \n  ggplot(aes(trait_value, group = plot)) +\n  geom_density() +\n  facet_wrap(~ trait, scales = \"free\") +\n  theme_bw() +\n  ggtitle(\"Tapajos Genus level\", \"19,188 inds represented on 19,499 (98.65%)\") +\n  theme(axis.title = element_blank(), legend.position = \"bottom\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\n\n\n\n\nBaraloto, Christopher, C. E. Timothy Paine, Sandra Patiño, Damien Bonal, Bruno Hérault, and Jerome Chave. 2010. “Functional Trait Variation and Sampling Strategies in Species-Rich Plant Communities.” Functional Ecology 24 (1): 208–16. https://doi.org/10.1111/j.1365-2435.2009.01600.x.\n\n\nGuillemot, Joannès, Nicolas K. Martin-StPaul, Leticia Bulascoschi, Lourens Poorter, Xavier Morin, Bruno X. Pinho, Guerric le Maire, et al. 2022. “Small and Slow Is Safe: On the Drought Tolerance of Tropical Tree Species.” Global Change Biology 28 (8): 2622–38. https://doi.org/10.1111/gcb.16082.\n\n\nJucker, Tommaso, Fabian Jörg Fischer, Jérôme Chave, David A. Coomes, John Caspersen, Arshad Ali, Grace Jopaul Loubota Panzou, et al. 2022. “Tallo: A Global Tree Allometry and Crown Architecture Database.” Global Change Biology 28 (17): 5254–68. https://doi.org/10.1111/gcb.16302.\n\n\nKattge, Jens, Gerhard Bönisch, and et al. 2020. “TRY Plant Trait Database – Enhanced Coverage and Open Access.” Global Change Biology 26: 119–88. https://doi.org/10.1111/gcb.14904.\n\n\nMaréchaux, Isabelle, Megan K. Bartlett, Lawren Sack, Christopher Baraloto, Julien Engel, Emilie Joetzjer, and Jérôme Chave. 2015. “Drought Tolerance as Predicted by Leaf Water Potential at Turgor Loss Point Varies Strongly Across Species Within an Amazonian Forest.” Edited by Kaoru Kitajima. Functional Ecology 29 (10): 1268–77. https://doi.org/10.1111/1365-2435.12452.\n\n\nMaréchaux, Isabelle, and Jérôme Chave. 2017. “An Individual-Based Forest Model to Jointly Simulate Carbon and Tree Diversity in Amazonia: Description and Applications.” Ecological Monographs 87 (4): 632–64. https://doi.org/10.1002/ecm.1271.\n\n\nMaréchaux, Isabelle, Laurent Saint-André, Megan K. Bartlett, Lawren Sack, and Jérôme Chave. 2019. “Leaf Drought Tolerance Cannot Be Inferred from Classic Leaf Traits in a Tropical Rainforest.” Edited by Pierre Mariotte. Journal of Ecology 108 (3): 1030–45. https://doi.org/10.1111/1365-2745.13321.\n\n\nNemetschek, Daniela, Géraldine Derroire, Eric Marcon, Mélaine Aubry-Kientz, Johanna Auer, Vincyane Badouard, Christopher Baraloto, et al. 2024. “Climate Anomalies and Neighbourhood Crowding Interact in Shaping Tree Growth in Old-Growth and Selectively Logged Tropical Forests.” Journal of Ecology, January. https://doi.org/10.1111/1365-2745.14256.\n\n\nSchmitt, Sylvain, and Marion Boisseaux. 2023. “Higher Local Intra- Than Interspecific Variability in Water- and Carbon-Related Leaf Traits Among Neotropical Tree Species.” Annals of Botany 131 (5): 801–11. https://doi.org/10.1093/aob/mcad042.\n\n\nVleminckx, Jason, Claire Fortunel, Oscar Valverde-Barrantes, C. E. Timothy Paine, Julien Engel, Pascal Petronelli, Aurélie K. Dourdain, Juan Guevara, Solène Béroujon, and Christopher Baraloto. 2021. “Resolving Whole-Plant Economics from Leaf, Stem and Root Traits of 1467 Amazonian Tree Species.” Oikos 130 (7): 1193–1208. https://doi.org/10.1111/oik.08284."
  },
  {
    "objectID": "13_soil.html",
    "href": "13_soil.html",
    "title": "Soil",
    "section": "",
    "text": "Soil data have been collected by Jérémy Lischtein (pers. com.) for Paracou and Tapajos. They include:\n\nSilt, clay, and sand fraction in percent for Paracou (Van Langenhove et al. (2021): Table 1, slope SLD soils, 0-30 cm and Gourlet-Fleury et al. (2004): Table 3, deep ferralitic soils, 0-40 cm) and Tapajos (Silver et al. (2000): Table 5, gradient position 350).\nSoil Organic Carbon (SOC) in percent for Paracou (Van Langenhove et al. (2021): mean of slope SLD soil values (0-30 cm depth) in Tables 2-3, dry and wet seasons averaged) and Tapajos (Quesada et al. (2010): Table S2, 0-30 cm depth).\nDry Bulk Density (DBD) in for Paracou (Van Langenhove et al. (2021): mean over 0-30 cm depth for superficial lateral drainage (SLD) slope soils) and Tapajos (Silver et al. (2000): mean for clay soils (0-10 cm depth) from Table 1, gradient positions 350 and 400).\npH for Paracou (Van Langenhove et al. (2021): mean of slope SLD soil values 0-30 cm depth in Table 1) and Tapajos (Quesada et al. (2010): Table S2, 0-30 cm).\nCation Exchange Capcity (CEC) in miliequivalent per 100 grammes for Paracou (Sabatier et al. (1997): Table 2, SLD soils, 0-30 cm) and Tapajos (Quesada et al. (2010): Table S2, 0-30 cm depth).\nSoil depth in metre based on no drainage barrier to at least 12 m depth (Nepstad et al. 2002) for Tapajos.\n\n\n\nCode\nlist(\n  tapajos = read_tsv(\"data/soil/TROLLv4_soil_MIP_vG_TNF.txt\"),\n  paracou = read_tsv(\"data/soil/TROLLv4_soil_MIP_vG.txt\")) %&gt;% \n  bind_rows(.id = \"site\") %&gt;% \n  group_by(site, proportion_Silt, proportion_Clay, proportion_Sand,\n           SOC, DBD, pH, CEC) %&gt;% \n  summarise(depth = max(layer_thickness)) %&gt;%\n  knitr::kable(col.names = c(\"\", \"silt\", \"clay\", \"sand\", \"SOC\", \"DBD\", \"pH\", \"CEC\", \"depth\"))\n\n\n\n\n\n\nsilt\nclay\nsand\nSOC\nDBD\npH\nCEC\ndepth\n\n\n\n\nparacou\n13.25\n21.50\n65.25\n2.37\n1.040\n4.34\n2.98\n0.97\n\n\ntapajos\n2.64\n60.09\n37.27\n2.54\n1.125\n3.84\n2.97\n12.10\n\n\n\n\n\n\n\n\n\nNepstad, D. C., P. Moutinho, M. B. Dias-Filho, E. Davidson, G. Cardinot, D. Markewitz, R. Figueiredo, et al. 2002. “The Effects of Partial Throughfall Exclusion on Canopy Processes, Aboveground Production, and Biogeochemistry of an Amazon Forest.” Journal of Geophysical Research: Atmospheres 107 (D20). https://doi.org/10.1029/2001jd000360.\n\n\nQuesada, C. A., J. Lloyd, M. Schwarz, S. Patiño, T. R. Baker, C. Czimczik, N. M. Fyllas, et al. 2010. “Variations in Chemical and Physical Properties of Amazon Forest Soils in Relation to Their Genesis.” Biogeosciences 7 (5): 1515–41. https://doi.org/10.5194/bg-7-1515-2010.\n\n\nSabatier, Daniel, Michel Grimaldi, Marie-Françoise Prévost, Julie Guillaume, Michel Godron, Mireille Dosso, and Daniel Sabatier. 1997. “The Influence of Soil Cover Organization on the Floristic and Structural Heterogeneity of a Guianan Rain Forest.” Plant Ecology Formerly “Vegetatio” 131 (1): 81–108. https://doi.org/10.1023/a:1009775025850.\n\n\nSilver, Whendee L., Jason Neff, Megan McGroddy, Ed Veldkamp, Michael Keller, and Raimundo Cosme. 2000. “Effects of Soil Texture on Belowground Carbon and Nutrient Storage in a Lowland Amazonian Forest Ecosystem.” Ecosystems 3 (2): 193–209. https://doi.org/10.1007/s100210000019.\n\n\nVan Langenhove, Leandro, Thomas Depaepe, Lore T. Verryckt, Helena Vallicrosa, Lucia Fuchslueger, Laynara F. Lugli, Laëtitia Bréchet, et al. 2021. “Impact of Nutrient Additions on Free-Living Nitrogen Fixation in Litter and Soil of Two French-Guianese Lowland Tropical Forests.” Journal of Geophysical Research: Biogeosciences 126 (7). https://doi.org/10.1029/2020jg006023."
  },
  {
    "objectID": "14_climate.html#era5-land",
    "href": "14_climate.html#era5-land",
    "title": "Climate",
    "section": "ERA5-Land",
    "text": "ERA5-Land\nERA5-Land is a global reanalysis dataset (Muñoz-Sabater et al. 2021). ERA5-Land at Paracou was retrieved from the Climate Data Store (CDS) using the R package rcontroll (Schmitt et al. 2023). ERA5-Land at Tapajos was retrieved from Open-Meteo using mamba environment and python script available in the data folder. ERA5-Land was mainly used to validate FLUXNET 2015 and gap-filling."
  },
  {
    "objectID": "14_climate.html#fluxnet-2015",
    "href": "14_climate.html#fluxnet-2015",
    "title": "Climate",
    "section": "FLUXNET 2015",
    "text": "FLUXNET 2015\nFLUXNET 2015 (Pastorello, Gilberto et al. 2020) at Paracou and Tapajos was retrieved freely from FLUXNET (the manifest is available in data). They are mainly used for TROLL model forcing but also include fluxes for TROLL simulations validation. However, FLUXNET 2015 precipitation data at Tapajos are not reliable, we thus replaced it with precipitation from ERA5-Land.\n\nThe FLUXNET2015 Dataset includes data collected at sites from multiple regional flux networks. The preparation of this FLUXNET Dataset has been possible thanks only to the efforts of many scientists and technicians around the world and the coordination among teams from regional networks.\n\nPI: Damien Bonal (Paracou), Mike Goulden (Tapajos), Scott Saleska (Tapajos)\n\n\nCode\nfluxnet &lt;- list(\n  \"Paracou\" = \"data/climate/FLX_GF-Guy_FLUXNET2015_SUBSET_HH_2004-2014_2-4.csv\",\n  \"Tapajos\" = \"data/climate/FLX_BR-Sa1_FLUXNET2015_SUBSET_HR_2002-2011_1-4.csv\"\n) %&gt;% \n  lapply(vroom::vroom, na = \"-9999\") %&gt;% \n  bind_rows(.id = \"site\") %&gt;% \n  select(site, TIMESTAMP_START, TIMESTAMP_END, P_F, SW_IN_F, \n         TA_F, VPD_F, WS_F, GPP_NT_VUT_REF, LE_F_MDS) %&gt;% \n  mutate(time = as_datetime(as.character(as.POSIXlt(as.character(TIMESTAMP_START), \n                                                    format = \"%Y%m%d%H%M\")))) %&gt;% \n  rename(rainfall = P_F, snet = SW_IN_F, temperature = TA_F, vpd = VPD_F, ws = WS_F) %&gt;% \n  mutate(vpd = vpd/10) %&gt;% \n  select(site, time, rainfall, snet, temperature, vpd, ws)\nfluxnet_tapajos &lt;- filter(fluxnet, site == \"Tapajos\")\nera &lt;- vroom::vroom(\"data/climate/era5_tapajos.csv\") %&gt;% \n  filter(year(date) &gt; 2001) %&gt;% \n  mutate(time = as_datetime(date), rainfall = precipitation) %&gt;% \n  select(time, rainfall)\nfluxnet_tapajos &lt;- fluxnet_tapajos %&gt;% \n  select(-rainfall) %&gt;% \n  left_join(era)\ntime_freq &lt;- 0.5 # TROLL v4\nstart &lt;- as_datetime(as_date(min(fluxnet_tapajos$time))) # to start from 00:30\nstop &lt;- max(fluxnet_tapajos$time) + 30*60 # to stop at 23:00\ntime &lt;- seq(start, stop, by = 60 * 60 * time_freq)\ndata &lt;- left_join(tibble(time = time),\n    fluxnet_tapajos,\n    by = \"time\"\n  ) %&gt;%\n  group_by(date = as_date(time)) %&gt;%\n  mutate(across(c(temperature, vpd, ws),\n                ~ zoo::na.spline(., time, na.rm = FALSE))) %&gt;% \n  mutate(across(c(snet),\n                ~ zoo::na.approx(., time, na.rm = FALSE))) %&gt;% \n  ungroup() %&gt;% \n  select(-date) %&gt;% \n  mutate(across(c(snet), ~ ifelse(is.na(.), 0, .))) %&gt;% \n  mutate(across(c(snet), ~ ifelse(. &lt; 0, 0, .))) %&gt;% \n  mutate(site = \"Tapajos\")\nbind_rows(filter(fluxnet, site == \"Paracou\"), data) %&gt;% \n  write_tsv(\"outputs/fluxnet_climate.tsv\")"
  },
  {
    "objectID": "14_climate.html#comparisons",
    "href": "14_climate.html#comparisons",
    "title": "Climate",
    "section": "Comparisons",
    "text": "Comparisons\nERA5-Land and FLUXNET2015 showed high correlation which comforted us in using ERA5-Land to gap-fill FLUXNET2015 precipitaiton data at Tapajos.\n\n\nCode\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;% \n  gather(variable, fluxnet, -time, -site) %&gt;% \n  left_join(read_tsv(\"data/climate/era5_Paracou.tsv\") %&gt;% \n              gather(variable, era, -time) %&gt;% \n              mutate(site = \"Paracou\")) %&gt;% \n  na.omit() %&gt;% \n  group_by(site, variable, date = floor_date(time, \"month\")) %&gt;% \n  select(-time) %&gt;% \n  mutate_all(~ ifelse(variable == \"rainfall\", sum(.), .)) %&gt;% \n  summarise_all(mean) %&gt;% \n  ggplot(aes(fluxnet, era)) +\n  geom_point(alpha = 0.5, col = \"lightgrey\") +\n  facet_wrap(~ variable, scales = \"free\") +\n  geom_abline(linetype = \"dashed\") +\n  ggpubr::stat_cor() +\n  theme_bw() +\n  ggtitle(\"Monthly variations\")"
  },
  {
    "objectID": "14_climate.html#input-data",
    "href": "14_climate.html#input-data",
    "title": "Climate",
    "section": "Input data",
    "text": "Input data\nTROLL input data for climate includes:\n\ndaily rainfall (mm)\nhalf-hourly day net radiation (snet, W/m2)\nhalf-hourly day temperature (°C)\nhalf-hourly day vapor pressure deficit (vpd, Pa)\nhalf-hourly day wind speed (m/s)\n\nWe thus need to defined day limits in time at a half-hourly precision. For that we used daily variations of snet. We thus used 7-19h for Paracou and 6-18h for Tapajos.\n\n\nCode\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;% \n  group_by(site, time = hms::as_hms(time)) %&gt;% \n    summarise(l = quantile(snet, 0.025, na.rm = TRUE), \n            m = mean(snet, na.rm = TRUE), \n            h = quantile(snet, 0.975, na.rm = TRUE)) %&gt;% \n  mutate(time = as.numeric(time)/(60*60)) %&gt;% \n  ggplot(aes(time, m, col = site, fill = site)) +\n  geom_vline(data = data.frame(time = c(7, 19, 6, 18), \n                               site = c(\"Paracou\", \"Paracou\",\n                                        \"Tapajos\", \"Tapajos\")), \n             aes(xintercept = time, col = site), \n             linetype = \"dashed\", linewidth = 1.5) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_line() +\n  geom_point() +\n  theme_bw() +\n  theme(axis.title = element_blank(), legend.position = \"bottom\") +\n  ggtitle(\"Half-hourly variations\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n  geom_vline(xintercept = c(7, 19), linetype = \"dotted\")"
  },
  {
    "objectID": "14_climate.html#dry-seasons",
    "href": "14_climate.html#dry-seasons",
    "title": "Climate",
    "section": "Dry seasons",
    "text": "Dry seasons\nFor representation and discussion purposes we defined dry season as 15-days period below 50 mm in means across years (corresponding to month below 100 mm from BONAL et al. (2008) but see Fu et al. (2013) for a more precise approach). We thus defined a 4-month dry season in Paracou from 8/1 to 12/1 and an almost 5-month dry season in Tapajos from 6/15 to 11/1.\n\n\nCode\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;%\n  group_by(site, date = floor_date(time, \"15 days\")) %&gt;% \n  summarise(rainfall = sum(rainfall, na.rm = TRUE)) %&gt;% \n  mutate(week = week(date), year = year(date)) %&gt;% \n  mutate() %&gt;% \n  ggplot(aes(week,  rainfall)) +\n  geom_rect(aes(xmin = week, xmax = end), fill  = \"#fff4e0\",\n           ymin = -Inf, ymax = Inf, alpha = 0.5,\n           data = data.frame(week = week(as_date(c(\"2000-8-1\", \"2000-06-15\"))),\n                             rainfall = -Inf,\n                             end = week(as_date(c(\"2000-12-1\", \"2000-11-1\"))),\n                             site = c(\"Paracou\", \"Tapajos\"))) +\n  geom_line(aes(group = year), col = \"grey\") +\n  theme_bw() +\n  facet_wrap(~ site) +\n  geom_smooth(col = \"black\", se = FALSE) +\n  scale_x_continuous(breaks = week(as_date(paste(\"2000-\", 1:12, \"-01\"))),\n                     labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\")) +\n  theme(axis.title = element_blank()) +\n  geom_hline(yintercept = 50, linetype = \"dashed\")"
  },
  {
    "objectID": "14_climate.html#variations-in-time",
    "href": "14_climate.html#variations-in-time",
    "title": "Climate",
    "section": "Variations in time",
    "text": "Variations in time\nFor data exploration purposes, we represented climate variations at multiple time steps (year, month, half-month, week, day, and half-hour), but ultimately TROLL is forced with half-hourly variations except for precipitation which is daily.\n\n\nCode\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;% \n  gather(variable, value, -site, -time) %&gt;% \n  group_by(site, variable, date = date(time)) %&gt;% \n  select(-time) %&gt;% \n   mutate(value = ifelse(variable %in% c(\"rainfall\", \"snet\"),\n                           sum(value, na.rm = T), value)) %&gt;% \n  summarise_all(mean) %&gt;% \n  group_by(site, variable, year = year(date)) %&gt;% \n  select(-date) %&gt;% \n  mutate(value = ifelse(variable %in% c(\"rainfall\"),\n                           sum(value, na.rm = T), value)) %&gt;% \n    summarise(l = quantile(value, 0.025, na.rm = TRUE), \n            m = mean(value, na.rm = TRUE), \n            h = quantile(value, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(year, m, col = site, fill = site)) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_line() +\n  geom_point() +\n  theme_bw() +\n  theme(axis.title = element_blank(), legend.position = c(0.8, 0.2)) +\n  ggtitle(\"Yearly variations of daily means\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n  facet_wrap(~ variable, scales = \"free_y\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;% \n  gather(variable, value, -site, -time) %&gt;% \n  group_by(site, variable, date = floor_date(time, \"month\")) %&gt;% \n  select(-time) %&gt;% \n  mutate(value = ifelse(variable %in% c(\"rainfall\"),\n                           sum(value, na.rm = T), value)) %&gt;% \n  summarise_all(mean) %&gt;%\n  group_by(month = month(date)) %&gt;% \n  mutate(week = mean(week(date))) %&gt;%  \n  group_by(site, variable, week) %&gt;% \n  summarise(l = quantile(value, 0.025, na.rm = TRUE), \n            m = mean(value, na.rm = TRUE), \n            h = quantile(value, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(week, m, col = site, fill = site)) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_line() +\n  geom_point() +\n  theme_bw() +\n  theme(axis.title = element_blank(), legend.position = c(0.8, 0.2)) +\n  ggtitle(\"Monthly means variations\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n  facet_wrap(~ variable, scales = \"free_y\") +\n    scale_x_continuous(breaks = week(as_date(paste(\"2000-\", 1:12, \"-01\"))),\n                     labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"))\n\n\n\n\n\n\n\nCode\nfloor_biweek &lt;- function(full) \n  as_date(paste0(year(full), \"-\", month(full), \"-\", ifelse(day(full) &gt; 15, 15, 1)))\n\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;% \n  gather(variable, value, -site, -time) %&gt;% \n  group_by(site, variable, date = floor_date(time, \"15 days\")) %&gt;% \n  select(-time) %&gt;% \n  mutate(value = ifelse(variable %in% c(\"rainfall\"),\n                           sum(value, na.rm = T), value)) %&gt;% \n  summarise_all(mean) %&gt;%\n  mutate(week = week(floor_biweek(date))) %&gt;%  \n  group_by(site, variable, week) %&gt;% \n  summarise(l = quantile(value, 0.025, na.rm = TRUE), \n            m = mean(value, na.rm = TRUE), \n            h = quantile(value, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(week, m, col = site, fill = site)) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_smooth(se = FALSE) +\n  theme_bw() +\n  theme(axis.title = element_blank(), legend.position = c(0.8, 0.2)) +\n  ggtitle(\"15-days means variations\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n  facet_wrap(~ variable, scales = \"free_y\") +\n    scale_x_continuous(breaks = week(as_date(paste(\"2000-\", 1:12, \"-01\"))),\n                     labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;% \n  gather(variable, value, -site, -time) %&gt;% \n  group_by(site, variable, date = floor_date(time, \"week\")) %&gt;% \n  select(-time) %&gt;% \n  mutate(value = ifelse(variable %in% c(\"rainfall\"),\n                           sum(value, na.rm = T), value)) %&gt;% \n  summarise_all(mean) %&gt;%\n  group_by(site, variable, week = week(date)) %&gt;% \n  mutate(value = ifelse(variable %in% c(\"rainfall\"),\n                           sum(value, na.rm = T), value)) %&gt;% \n  summarise(l = quantile(value, 0.025, na.rm = TRUE), \n            m = mean(value, na.rm = TRUE), \n            h = quantile(value, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(week, m, col = site, fill = site)) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_line() +\n  geom_point() +\n  theme_bw() +\n  theme(axis.title = element_blank(), legend.position = c(0.8, 0.2)) +\n  ggtitle(\"Weekly means variations\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n  facet_wrap(~ variable, scales = \"free_y\") +\n    scale_x_continuous(breaks = week(as_date(paste(\"2000-\", 1:12, \"-01\"))),\n                     labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;% \n  gather(variable, value, -site, -time) %&gt;% \n  group_by(site, variable, date = floor_date(time, \"day\")) %&gt;% \n  select(-time) %&gt;% \n  mutate(value = ifelse(variable %in% c(\"rainfall\"),\n                           sum(value, na.rm = T), value)) %&gt;% \n  summarise_all(mean) %&gt;%\n  group_by(site, variable, day = yday(date)) %&gt;% \n  summarise(l = quantile(value, 0.025, na.rm = TRUE), \n            m = mean(value, na.rm = TRUE), \n            h = quantile(value, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(day, m, col = site, fill = site)) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_line() +\n  theme_bw() +\n  theme(axis.title = element_blank(), legend.position = c(0.8, 0.2)) +\n  ggtitle(\"Weekly means variations\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n  facet_wrap(~ variable, scales = \"free_y\") +\n    scale_x_continuous(breaks = yday(as_date(paste(\"2000-\", 1:12, \"-01\"))),\n                     labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"))\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/fluxnet_climate.tsv\") %&gt;% \n  gather(variable, value, -site, -time) %&gt;% \n  filter(variable %in% c(\"snet\", \"temperature\", \"vpd\", \"ws\")) %&gt;% \n  group_by(site, variable, time = hms::as_hms(time)) %&gt;% \n    summarise(l = quantile(value, 0.025, na.rm = TRUE), \n            m = mean(value, na.rm = TRUE), \n            h = quantile(value, 0.975, na.rm = TRUE)) %&gt;% \n  mutate(time = as.numeric(time)/(60*60)) %&gt;% \n  ggplot(aes(time, m, col = site, fill = site)) +\n  geom_vline(data = data.frame(time = c(7, 19, 6, 18), \n                               site = c(\"Paracou\", \"Paracou\",\n                                        \"Tapajos\", \"Tapajos\")), \n             aes(xintercept = time, col = site), linetype = \"dashed\") +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_line() +\n  geom_point() +\n  theme_bw() +\n  facet_wrap(~ variable, scales = \"free\") +\n  theme(axis.title = element_blank(), legend.position = \"bottom\") +\n  ggtitle(\"Half-hourly variations\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\")\n\n\n\n\n\n\n\n\n\nBONAL, DAMIEN, ALEXANDRE BOSC, STÉPHANE PONTON, JEAN-YVES GORET, BENOÎT BURBAN, PATRICK GROSS, JEAN-MARC BONNEFOND, et al. 2008. “Impact of Severe Dry Season on Net Ecosystem Exchange in the Neotropical Rainforest of French Guiana.” Global Change Biology 14 (8): 1917–33. https://doi.org/10.1111/j.1365-2486.2008.01610.x.\n\n\nFu, Rong, Lei Yin, Wenhong Li, Paola A. Arias, Robert E. Dickinson, Lei Huang, Sudip Chakraborty, et al. 2013. “Increased Dry-Season Length over Southern Amazonia in Recent Decades and Its Implication for Future Climate Projection.” Proceedings of the National Academy of Sciences 110 (45): 18110–15. https://doi.org/10.1073/pnas.1302584110.\n\n\nMuñoz-Sabater, Joaquín, Emanuel Dutra, Anna Agustí-Panareda, Clément Albergel, Gabriele Arduini, Gianpaolo Balsamo, Souhail Boussetta, et al. 2021. “ERA5-Land: A State-of-the-Art Global Reanalysis Dataset for Land Applications.” Earth System Science Data 13 (9): 4349–83. https://doi.org/10.5194/essd-13-4349-2021.\n\n\nPastorello, Gilberto, Trotta, Carlo, Canfora, Eleonora, Chu, Housen, Christianson, Danielle, Cheah, You-Wei, Poindexter, Cristina, et al. 2020. “The FLUXNET2015 Dataset and the ONEFlux Processing Pipeline for Eddy Covariance Data.” Nature Publishing Group. https://doi.org/10.5167/UZH-190509.\n\n\nSchmitt, Sylvain, Guillaume Salzet, Fabian Jörg Fischer, Isabelle Maréchaux, and Jerome Chave. 2023. “Rcontroll: An R Interface for the Individual-Based Forest Dynamics Simulator TROLL.” Methods in Ecology and Evolution 14 (11): 2749–57. https://doi.org/10.1111/2041-210x.14215."
  },
  {
    "objectID": "15_fluxes.html#carbon-and-water-fluxes---fluxnet",
    "href": "15_fluxes.html#carbon-and-water-fluxes---fluxnet",
    "title": "Fluxes",
    "section": "Carbon and water fluxes - FLUXNET",
    "text": "Carbon and water fluxes - FLUXNET\nFLUXNET 2015 (Pastorello, Gilberto et al. 2020) at Paracou and Tapajos was retrieved freely from FLUXNET (the manifest is available in data). They are mainly used for TROLL model forcing but also include fluxes for TROLL simulations validation including growth primary productivity (GPP) and evapotranspiration (ET). We also computed Photosynthetically Active Radiation (PAR) as it is a driver of GPP, and daily maximum Vapour Pressure Deficit (VPD) as it is a driver of ET. We removed GPP and ET data between 2006 and 2009 in Tapajos due to a known incident with the sensors.\n\nThe FLUXNET2015 Dataset includes data collected at sites from multiple regional flux networks. The preparation of this FLUXNET Dataset has been possible thanks only to the efforts of many scientists and technicians around the world and the coordination among teams from regional networks.\n\nPI: Damien Bonal (Paracou), Mike Goulden (Tapajos), Scott Saleska (Tapajos)\n\n\nCode\nlambda &lt;- function(t_air) 2.501 - (2.361*10^-3)*t_air\nfluxnet &lt;- list(\n  \"Paracou\" = \"data/climate/FLX_GF-Guy_FLUXNET2015_SUBSET_HH_2004-2014_2-4.csv\",\n  \"Tapajos\" = \"data/climate/FLX_BR-Sa1_FLUXNET2015_SUBSET_HR_2002-2011_1-4.csv\"\n) %&gt;% \n  lapply(vroom::vroom, na = \"-9999\") %&gt;% \n  bind_rows(.id = \"site\") %&gt;% \n  select(site, TIMESTAMP_START, TIMESTAMP_END, P_F, SW_IN_F, \n         TA_F, VPD_F, WS_F, GPP_NT_VUT_REF, LE_F_MDS) %&gt;% \n  mutate(time = as_datetime(as.character(as.POSIXlt(as.character(TIMESTAMP_START), \n                                                    format = \"%Y%m%d%H%M\")))) %&gt;% \n  rename(rainfall = P_F, snet = SW_IN_F, temperature = TA_F, vpd = VPD_F, ws = WS_F,\n         gpp = GPP_NT_VUT_REF, le = LE_F_MDS) %&gt;% \n  mutate(et = 10^-6*le*60*30 / lambda(temperature)) %&gt;% # W.m-2.half-hour to MJ.s-1 to kg.m-2.half-hour\n  mutate(et = ifelse(hour(time) %in% 7:18, et, NA)) %&gt;% \n  mutate(vpd = vpd/10,\n         gpp = gpp/100, par = snet*2.27*60*30/10^3) %&gt;% \n  select(site, time, vpd, par, gpp, et)\nfluxnet_tapajos &lt;- filter(fluxnet, site == \"Tapajos\")\ntime_freq &lt;- 0.5 # TROLL v4\nstart &lt;- as_datetime(as_date(min(fluxnet_tapajos$time))) # to start from 00:30\nstop &lt;- max(fluxnet_tapajos$time) + 30*60 # to stop at 23:00\ntime &lt;- seq(start, stop, by = 60 * 60 * time_freq)\ndata &lt;- left_join(tibble(time = time),\n    fluxnet_tapajos,\n    by = \"time\"\n  ) %&gt;%\n  group_by(date = as_date(time)) %&gt;%\n  mutate(across(c(vpd, gpp),\n                ~ zoo::na.spline(., time, na.rm = FALSE))) %&gt;% \n  mutate(across(c(par, et),\n                ~ zoo::na.approx(., time, na.rm = FALSE))) %&gt;% \n  ungroup() %&gt;% \n  select(-date) %&gt;% \n  mutate(across(c(par), ~ ifelse(is.na(.), 0, .))) %&gt;% \n  mutate(across(c(par), ~ ifelse(. &lt; 0, 0, .))) %&gt;% \n  mutate(site = \"Tapajos\")\nbind_rows(filter(fluxnet, site == \"Paracou\"), data) %&gt;% \n    mutate(vpd_max = vpd) %&gt;% \n  select(-vpd) %&gt;% \n  gather(variable, value, -site, -time) %&gt;% \n  group_by(site, variable, date = date(time)) %&gt;%\n  select(-time) %&gt;% \n  mutate(value = ifelse(value %in% c(\"et\", \"par\"),\n                           sum(value, na.rm = T), value)) %&gt;% \n  mutate(value = ifelse(variable %in% c(\"vpd_max\"),\n                           max(value, na.rm = T), value)) %&gt;% \n  summarise_all(mean, na.rm = T) %&gt;% \n  mutate(value = ifelse(variable %in% c(\"et\", \"gpp\") & site == \"Tapajos\" & year(date) %in% 2006:2009,\n                           NA, value)) %&gt;% \n  write_tsv(\"outputs/fluxnet_fluxes.tsv\")\n\n\n\n\nCode\nread_tsv(\"outputs/fluxnet_fluxes.tsv\") %&gt;% \n  ggplot(aes(date, value, col = site)) +\n  geom_line(alpha = 0.5) +\n  geom_line(data = read_tsv(\"outputs/fluxnet_fluxes.tsv\") %&gt;% \n  group_by(variable, site, date = floor_date(date, \"month\")) %&gt;% \n  summarise_all(mean)) +\n  theme_bw() +\n  facet_wrap(~ variable, scales = \"free_y\") +\n  theme(axis.title = element_blank())\n\n\n\n\n\n\n\nCode\nfloor_biweek &lt;- function(full) \n  as_date(paste0(year(full), \"-\", month(full), \"-\", ifelse(day(full) &gt; 15, 15, 1)))\nread_tsv(\"outputs/fluxnet_fluxes.tsv\") %&gt;% \n  group_by(site, variable, date = floor_date(date, \"15 days\")) %&gt;% \n  summarise_all(mean, na.rm = T) %&gt;%\n  mutate(week = week(floor_biweek(date))) %&gt;%  \n  group_by(site, variable, week) %&gt;% \n  summarise(l = quantile(value, 0.025, na.rm = TRUE), \n            m = mean(value, na.rm = TRUE), \n            h = quantile(value, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(week, m, col = site, fill = site)) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_smooth(se = FALSE) +\n  theme_bw() +\n  theme(axis.title = element_blank()) +\n  ggtitle(\"15-days means variations\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n  facet_wrap(~ variable, scales = \"free_y\") +\n    scale_x_continuous(breaks = week(as_date(paste(\"2000-\", 1:12, \"-01\"))),\n                     labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"))"
  },
  {
    "objectID": "15_fluxes.html#carbon-flux---tropomi-sif",
    "href": "15_fluxes.html#carbon-flux---tropomi-sif",
    "title": "Fluxes",
    "section": "Carbon flux - TROPOMI SIF",
    "text": "Carbon flux - TROPOMI SIF\nTapajos and Paracou Solar Induced Fluorescence (SIF) from TROPOMI satellites was retrieved from https://figshare.com/ndownloader/articles/19336346/versions/2 and processed with the R script available in data. The SIF values were converted in Growth Primary Productivity (GPP) using \\(GPP = 15.343 \\times SIF\\) following Chen et al. (2022).\n\n\nCode\nread_tsv(\"data/fluxes/rtsif.tsv\") %&gt;% \n  mutate(value = rtsif*15.343*365/10^3) %&gt;% \n  ggplot(aes(date, value)) +\n  geom_line(alpha = 0.5, aes(col = site)) +\n  theme_bw() +\n  theme(legend.position = \"bottom\") +\n  xlab(\"\") + ylab(\"Growth Primary Productivity (kgC/m2/yr)\")\n\n\n\n\n\n\n\nCode\nread_tsv(\"data/fluxes/rtsif.tsv\") %&gt;% \n  mutate(value = rtsif*15.343*365/10^3) %&gt;% \n  mutate(week = week(date)) %&gt;% \n  group_by(site, week) %&gt;% \n  summarise(l = quantile(value*5, 0.025, na.rm = TRUE), \n            m = quantile(value*5, 0.5, na.rm = TRUE), \n            h = quantile(value*5, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(week, m, col = site, fill = site)) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_smooth(se = FALSE) +\n  geom_point() +geom_line() +\n  theme_bw() +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n    scale_x_continuous(breaks = week(as_date(paste(\"2000-\", 1:12, \"-01\"))),\n                     labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\")) +\n  xlab(\"\") + ylab(\"Growth Primary Productivity (kgC/m2/yr)\")"
  },
  {
    "objectID": "15_fluxes.html#soil-water-content---guyaflux",
    "href": "15_fluxes.html#soil-water-content---guyaflux",
    "title": "Fluxes",
    "section": "Soil water content - Guyaflux",
    "text": "Soil water content - Guyaflux\nGuyaflux are Paracou Eddy Flux tower raw data (BONAL et al. 2008) from 2004 to 2022. Vapour Pressure Deficit (VPD, kPa) is computed from relative humidity (%). Data are available on demand and can be partly retrieved from PLUMBER2 (Ukkola, Abramowitz, and De Kauwe 2022) or FLUXNET (Pastorello, Gilberto et al. 2020). Guyaflux was mainly used for TROLL simulations validation including soil water content (SWC) at different depths.\nPI: Damien Bonal\n\n\nCode\nread_csv2(\"data/climate/GX-METEO^MEDDY-2004-2022.csv\",\n      locale = locale(decimal_mark = \",\")) %&gt;% \n  group_by(Year) %&gt;% \n  mutate(date = as_date(paste0(min(Year), \"/\", min(Month),\n                               \"/\", min(`Julian Day`))) + (`Julian Day` - 1)) %&gt;% \n    separate(`Hour/min`, c(\"hour\", \"minute\")) %&gt;% \n  ungroup() %&gt;% \n  mutate(minute = ifelse(is.na(minute), 0, 60*as.numeric(minute)/10)) %&gt;% \n  mutate(time = as_datetime(paste(as.character(date), paste0(hour, \":\", minute, \":00\")))) %&gt;% \n  mutate(time = time - 30*60) %&gt;% \n  filter(year(time)  %in% 2004:2014) %&gt;% \n  mutate(swc10 = `SWC (-10 cm)`,\n         swc20 = `SWC (-20 cm)`,\n         swc80 = `SWC (-80 cm)`,\n         swc160 = `SWC (-160 cm)`,\n         swc260 = `SWC (-260 cm)`) %&gt;%\n  mutate(site = \"Paracou\") %&gt;% \n  select(site, time, swc10, swc20, swc80, swc160, swc260) %&gt;% \n  group_by(site, date = date(time)) %&gt;% \n  summarise_all(mean, na.rm = TRUE) %&gt;% \n  select(-time) %&gt;% \n  gather(variable, value, -site, -date) %&gt;% \n  na.omit() %&gt;% \n  write_tsv(\"outputs/guyaflux_swc.tsv\")\n\n\n\n\nCode\nread_tsv(\"outputs/guyaflux_swc.tsv\") %&gt;% \n  mutate(depth = as.numeric(gsub(\"swc\", \"\", variable))) %&gt;% \n  group_by(depth, day = yday(date)) %&gt;% \n  summarise(l = quantile(value, 0.025, na.rm = TRUE), \n            m = mean(value, na.rm = TRUE), \n            h = quantile(value, 0.975, na.rm = TRUE)) %&gt;% \n  ggplot(aes(day, m, col = depth, fill = depth, group = depth)) +\n   annotate(\"rect\", xmin = 214, xmax = 306, fill  = \"#fff4e0\",\n           ymin = -Inf, ymax = Inf, alpha = 0.5) +\n  geom_ribbon(aes(ymin = l, ymax = h), col = NA, alpha = 0.2) +\n  geom_line() +\n  theme_bw() +\n  scale_color_viridis_c(direction = -1) +\n  scale_fill_viridis_c(direction = -1) +\n  theme(axis.title = element_blank()) +\n  ggtitle(\"Daily means variations of SWC in Paracou\") +\n  scale_x_continuous(breaks = c(1, 32, 61, 92, 122, 153, 183, 214, 245, 275, 306, 336),\n                   labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"))"
  },
  {
    "objectID": "15_fluxes.html#litterfall",
    "href": "15_fluxes.html#litterfall",
    "title": "Fluxes",
    "section": "Litterfall",
    "text": "Litterfall\nParacou litterfall were provided by Damien Bonal (D. Bonal pers. com.). Tapajos litterfall are available online through the Oak Ridge National Laboratory (ORNL) Distributed Active Archive Center (DAAC): https://daac.ornl.gov/LBA/guides/CD10_Litter_Tapajos.html . Litterfall data were mainly used the calibration of the new leaf phenology module in TROLL version 4. Leaf litterfall data were converted in fluxes over a defined time lag (depending on site and sampling date). For calibration two indices were derived for each years:\n\nLitterfall pike day as the day of the yearly maximum value\nLitterfall ratio as the ratio of the pike value (mean of the yearly maximum value and the previous and next values) divided by the basal flux (mean values between January and April)\n\n\n\nCode\nprop_paracou &lt;- vroom::vroom(\"data/fluxes/prop_litterfall.csv\", n_max = 4) %&gt;% \n  filter(date == \"feuille\") %&gt;% \n  select(-date) %&gt;% \n  gather(date, prop_leaf)  %&gt;% \n  mutate(date = as_date(date, format = \"%d/%m/%Y\")) %&gt;% \n  na.omit() %&gt;% \n  group_by(month = month(date)) %&gt;% \n  summarise(prop_leaf = quantile(prop_leaf, 0.5, na.rm = TRUE)/100)\nlitter_paracou &lt;- vroom::vroom(\"data/fluxes/litterfall_2003_2022.csv\") %&gt;% \n  rename(\"collector\" = \"Numero collecteur\", \"subplot\" = \"Carre guyaflux\") %&gt;% \n  gather(date, litter, -collector, -subplot) %&gt;% \n  mutate(date = as_date(date, format = \"%d/%m/%Y\")) %&gt;% \n  na.omit() %&gt;% \n  group_by(date) %&gt;% \n  summarise(litter = mean(litter)) %&gt;% \n  mutate(dt = as.numeric(date - lag(date))) %&gt;% \n  mutate(month = month(date)) %&gt;% \n  left_join(prop_paracou) %&gt;% \n  na.omit() %&gt;% \n  mutate(litterfall = litter*prop_leaf/dt/0.45*3.65) %&gt;% # only leaf from x/x/x to MgC/ha/year\n  mutate(site = 'Paracou') %&gt;% \n  select(date, dt, litterfall, site)\nlitter_tapajos &lt;- vroom::vroom(\"data/fluxes/CD10_Litter_Tapajos_862/data/lba_km67_litter_archive.txt\") %&gt;% \n  mutate(date = lubridate::as_date(as.character(YYYYMMDD), format = \"%Y%m%d\")) %&gt;% \n  mutate(site = 'Tapajos', litterfall = leaf, dt = dT) %&gt;% \n  select(date, dt, litterfall, site)\nbind_rows(litter_paracou, litter_tapajos) %&gt;% \n  write_tsv(file = \"outputs/litter.tsv\")\n\n\n\n\nCode\nobs_metrics &lt;- read_tsv(\"outputs/litter.tsv\") %&gt;% \n  group_by(site, year = year(date)) %&gt;% \n  summarise(pike = mean(c(litterfall[which.max(litterfall)],\n                          litterfall[which.max(litterfall)-1],\n                          litterfall[which.max(litterfall)+1]), na.rm = TRUE),\n            pike_date = date[which.max(litterfall)],\n            basal = mean(as.numeric(month(date) %in% 1:4)*litterfall, na.rm = TRUE)) %&gt;%  \n  mutate(pike_day = yday(pike_date), ratio = pike / basal) %&gt;% \n  filter(basal &gt; 0, pike_day &gt; 100)\n\n\n\n\nCode\nread_tsv(\"outputs/litter.tsv\") %&gt;% \n  ggplot(aes(date, litterfall, col = dt)) +\n  geom_line(col = \"lightgrey\", alpha = 0.5) +\n  geom_point() +\n  theme_bw() +\n  facet_wrap(~ site, scales = \"free\", nrow = 2) +\n  scale_color_viridis_c(\"Time lapse\") +\n  xlab(\"\") + ylab(\"Observed litterfall (MgC/ha/yr)\") +\n  geom_vline(aes(xintercept = pike_date), \n             data = obs_metrics, col = \"red\", linetype = \"dashed\") +\n  geom_point(aes(x = pike_date, y = pike), \n             data = obs_metrics, col = \"red\", size = 2)\n\n\n\n\n\n\n\nCode\nread_tsv(\"outputs/litter.tsv\") %&gt;% \n  ggplot(aes(yday(date), litterfall, col = year(date))) +\n  geom_smooth(method = \"lm\", formula = y ~ poly(x, 20, raw = TRUE)) +\n  geom_line(aes(group = as.factor(year(date))), col = \"lightgrey\", alpha = 0.5) +\n  geom_point() +\n  theme_bw() +\n  facet_wrap(~ site, scales = \"free\", nrow = 2) +\n  scale_color_viridis_c(\"Year\") +\n  xlab(\"\") + ylab(\"Observed litterfall (MgC/ha/yr)\") +\n  scale_x_continuous(breaks = yday(as_date(paste0(\"2001-\", 1:12, \"-1\"))),\n                   labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\")) +\n  geom_point(aes(x = pike_day, y = pike), \n             data = obs_metrics, col = \"red\", size = 2)\n\n\n\n\n\n\n\nCode\nobs_metrics %&gt;% \n  ggplot(aes(pike_day, ratio, col = site, size = year)) +\n  geom_point() +\n  theme_bw() +\n  ylab(\"Observed litterfall ratio\") +\n  xlab(\"Observed litterfall pike day\")"
  },
  {
    "objectID": "15_fluxes.html#canopy-structure",
    "href": "15_fluxes.html#canopy-structure",
    "title": "Fluxes",
    "section": "Canopy structure",
    "text": "Canopy structure\nCanopy structure and dynamics was assessed using Leaf Area Index (LAI), Leaf Area Density (LAD) and Plant Area Density (PAD) from local observation using terrestrial or drone LIDAR remotely-sensed by MODIS. LIDAR data includes drone data from Paracou provided by Nicolas Barbier Bonal (G. Vincent & N. Barbier pers. com.) and terrestrial data from Tapajos etrieved from Smith et al. (2019): https://nph.onlinelibrary.wiley.com/doi/10.1111/nph.15726. Remotely-sensed data from MODIS were retrieved from PLUMBER2 on Research Data Australia: https://researchdata.edu.au/plumber2-forcing-evaluation-surface-models/1656048.\n\n\nCode\nlibrary(sf)\nlibrary(terra)\nlibrary(ncdf4)\nroi &lt;- invisible(st_read(\"data/fluxes/paddense_central.gpkg\"))\npath &lt;- \"data/fluxes/dense_vox1m_angle45_newTif/\"\nfiles &lt;- list.files(path, full.names = TRUE)\nnames(files) &lt;- list.files(path)\npad &lt;- lapply(files, rast) %&gt;%\n  lapply(function(r) {\n    names(r) &lt;- c(\"dtm\", \"chm\", \"density\", \"angle\", \"bsi3m\", \"fpl3m\", \"pad3m\")\n    return(r)}) %&gt;%\n  lapply(terra::extract, roi) %&gt;%\n  bind_rows(.id = \"time\") %&gt;%\n  mutate(time = gsub(\".tif\", \"\", time)) %&gt;%\n  mutate(time = gsub(\"YS-\", \"\", time)) %&gt;%\n  mutate(time = as_datetime(time))\npad &lt;- pad %&gt;%\n  group_by(date = date(time)) %&gt;%\n  summarise(value = quantile(pad3m, 0.5, na.rm = T)*10) %&gt;% \n  mutate(site = \"Paracou\", variable = \"PAD\")\ndates &lt;- readxl::read_xlsx(\"~/Documents/data/Tapajos/nph15726-sup-0002-notess4.xlsx\", \n                  \"abs_height\", col_names = FALSE, skip = 0, n_max = 1) %&gt;% \n  select(-`...1`) %&gt;% \n  gather(key, date) %&gt;% \n  mutate(key = as.character(1:n()))\nlad &lt;- readxl::read_xlsx(\"~/Documents/data/Tapajos/nph15726-sup-0002-notess4.xlsx\", \n                  \"abs_height\", col_names = c(\"height\", dates$key), skip = 1) %&gt;% \n  gather(key, lad, -height) %&gt;% \n  left_join(dates) %&gt;% \n  mutate(date = as_date(date))\nlad &lt;- lad %&gt;%\n  group_by(date) %&gt;% \n  summarise(value = sum(lad)) %&gt;% \n  mutate(site = \"Tapajos\", variable = \"LAD\")\nr1 &lt;- nc_open(\"~/Documents/data/PLUMBER2/GF-Guy_2004-2014_FLUXNET2015_Met.nc\")\nr2 &lt;- nc_open(\"~/Documents/data/PLUMBER2/BR-Sa3_2001-2003_FLUXNET2015_Met.nc\")\nlai &lt;- list(Paracou = data.frame(lai = ncvar_get(r1, \"LAI\"),\n             time  = as_datetime(ncatt_get(r1, \"time\")$units) +\n             ncvar_get(r1, \"time\")),\n     Tapajos = data.frame(lai = ncvar_get(r2, \"LAI_alternative\"),\n             time  = as_datetime(ncatt_get(r2, \"time\")$units) +\n             ncvar_get(r2, \"time\"))) %&gt;% \n  bind_rows(.id = \"site\") %&gt;% \n  group_by(site, date = date(time), variable = \"LAI\") %&gt;% \n  summarise(value = mean(lai))\nbind_rows(pad, lad, lai) %&gt;% \n  write_tsv(file = \"outputs/lai.tsv\")\n\n\n\n\nCode\nread_tsv(\"outputs/lai.tsv\") %&gt;% \n  mutate(week = week(date)) %&gt;%  \n  ggplot(aes(week, value, col = site, fill = site)) +\n  geom_line(aes(group = year(date))) +\n  geom_smooth(se = FALSE) +\n  theme_bw() +\n  theme(axis.title = element_blank(), legend.position = \"bottom\") +\n  scale_fill_discrete(\"\") +\n  scale_color_discrete(\"\") +\n  facet_wrap(~ variable) +\n  scale_x_continuous(breaks = week(as_date(paste(\"2000-\", 1:12, \"-01\"))),\n                     labels = c(\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"))\n\n\n\n\n\n\n\n\n\nBONAL, DAMIEN, ALEXANDRE BOSC, STÉPHANE PONTON, JEAN-YVES GORET, BENOÎT BURBAN, PATRICK GROSS, JEAN-MARC BONNEFOND, et al. 2008. “Impact of Severe Dry Season on Net Ecosystem Exchange in the Neotropical Rainforest of French Guiana.” Global Change Biology 14 (8): 1917–33. https://doi.org/10.1111/j.1365-2486.2008.01610.x.\n\n\nChen, Xingan, Yuefei Huang, Chong Nie, Shuo Zhang, Guangqian Wang, Shiliu Chen, and Zhichao Chen. 2022. “A Long-Term Reconstructed TROPOMI Solar-Induced Fluorescence Dataset Using Machine Learning Algorithms.” Scientific Data 9 (1). https://doi.org/10.1038/s41597-022-01520-1.\n\n\nPastorello, Gilberto, Trotta, Carlo, Canfora, Eleonora, Chu, Housen, Christianson, Danielle, Cheah, You-Wei, Poindexter, Cristina, et al. 2020. “The FLUXNET2015 Dataset and the ONEFlux Processing Pipeline for Eddy Covariance Data.” Nature Publishing Group. https://doi.org/10.5167/UZH-190509.\n\n\nSmith, Marielle N., Scott C. Stark, Tyeen C. Taylor, Mauricio L. Ferreira, Eronaldo de Oliveira, Natalia Restrepo-Coupe, Shuli Chen, et al. 2019. “Seasonal and Drought-Related Changes in Leaf Area Profiles Depend on Height and Light Environment in an Amazon Forest.” New Phytologist 222 (3): 1284–97. https://doi.org/10.1111/nph.15726.\n\n\nUkkola, Anna M., Gab Abramowitz, and Martin G. De Kauwe. 2022. “A Flux Tower Dataset Tailored for Land Model Evaluation.” Earth System Science Data 14 (2): 449–61. https://doi.org/10.5194/essd-14-449-2022."
  },
  {
    "objectID": "20_experiment.html",
    "href": "20_experiment.html",
    "title": "Experiment",
    "section": "",
    "text": "phenology parameters\ncalibration approach\nexploring phenology\nvariations approach\nevaluation methods\nrcontroll v4\nsingularity image\nsnakemake workflow"
  },
  {
    "objectID": "30_results.html",
    "href": "30_results.html",
    "title": "Results",
    "section": "",
    "text": "Short description, and eventually brief summary"
  },
  {
    "objectID": "31_calibration.html",
    "href": "31_calibration.html",
    "title": "Calibration",
    "section": "",
    "text": "Parameters effect\nBest parameters"
  },
  {
    "objectID": "32_exploration.html",
    "href": "32_exploration.html",
    "title": "Exploration",
    "section": "",
    "text": "Fluxes exploration with generic or site dependent phenology parameters"
  },
  {
    "objectID": "33_variation.html",
    "href": "33_variation.html",
    "title": "Variation",
    "section": "",
    "text": "Fluxes variability across simulation"
  },
  {
    "objectID": "34_evaluation.html",
    "href": "34_evaluation.html",
    "title": "Evaluation",
    "section": "",
    "text": "Fluxes\nStructure\nComposition"
  },
  {
    "objectID": "40_discussion.html",
    "href": "40_discussion.html",
    "title": "Discussion",
    "section": "",
    "text": "Discuss\nConclude"
  },
  {
    "objectID": "99_references.html",
    "href": "99_references.html",
    "title": "References",
    "section": "",
    "text": "Baraloto, Christopher, C. E. Timothy Paine, Sandra Patiño, Damien Bonal,\nBruno Hérault, and Jerome Chave. 2010. “Functional Trait Variation\nand Sampling Strategies in Species-Rich Plant\nCommunities.” Functional Ecology 24 (1): 208–16. https://doi.org/10.1111/j.1365-2435.2009.01600.x.\n\n\nBONAL, DAMIEN, ALEXANDRE BOSC, STÉPHANE PONTON, JEAN-YVES GORET, BENOÎT\nBURBAN, PATRICK GROSS, JEAN-MARC BONNEFOND, et al. 2008. “Impact\nof Severe Dry Season on Net Ecosystem Exchange in the Neotropical\nRainforest of French Guiana.” Global Change Biology 14\n(8): 1917–33. https://doi.org/10.1111/j.1365-2486.2008.01610.x.\n\n\nChen, Xingan, Yuefei Huang, Chong Nie, Shuo Zhang, Guangqian Wang,\nShiliu Chen, and Zhichao Chen. 2022. “A Long-Term Reconstructed\nTROPOMI Solar-Induced Fluorescence Dataset Using Machine Learning\nAlgorithms.” Scientific Data 9 (1). https://doi.org/10.1038/s41597-022-01520-1.\n\n\nFu, Rong, Lei Yin, Wenhong Li, Paola A. Arias, Robert E. Dickinson, Lei\nHuang, Sudip Chakraborty, et al. 2013. “Increased Dry-Season\nLength over Southern Amazonia in Recent Decades and Its Implication for\nFuture Climate Projection.” Proceedings of the National\nAcademy of Sciences 110 (45): 18110–15. https://doi.org/10.1073/pnas.1302584110.\n\n\nGuillemot, Joannès, Nicolas K. Martin-StPaul, Leticia Bulascoschi,\nLourens Poorter, Xavier Morin, Bruno X. Pinho, Guerric le Maire, et al.\n2022. “Small and Slow Is Safe: On the Drought Tolerance of\nTropical Tree Species.” Global Change Biology 28 (8):\n2622–38. https://doi.org/10.1111/gcb.16082.\n\n\nJucker, Tommaso, Fabian Jörg Fischer, Jérôme Chave, David A. Coomes,\nJohn Caspersen, Arshad Ali, Grace Jopaul Loubota Panzou, et al. 2022.\n“Tallo: A Global Tree Allometry and Crown Architecture\nDatabase.” Global Change Biology 28 (17): 5254–68. https://doi.org/10.1111/gcb.16302.\n\n\nKattge, Jens, Gerhard Bönisch, and et al. 2020. “TRY Plant Trait\nDatabase – Enhanced Coverage and Open Access.” Global Change\nBiology 26: 119–88. https://doi.org/10.1111/gcb.14904.\n\n\nMaréchaux, Isabelle, Megan K. Bartlett, Lawren Sack, Christopher\nBaraloto, Julien Engel, Emilie Joetzjer, and Jérôme Chave. 2015.\n“Drought Tolerance as Predicted by Leaf Water Potential at Turgor\nLoss Point Varies Strongly Across Species Within an Amazonian\nForest.” Edited by Kaoru Kitajima. Functional Ecology 29\n(10): 1268–77. https://doi.org/10.1111/1365-2435.12452.\n\n\nMaréchaux, Isabelle, and Jérôme Chave. 2017. “An\nIndividual-Based Forest Model to Jointly Simulate Carbon\nand Tree Diversity in Amazonia: Description and Applications.”\nEcological Monographs 87 (4): 632–64. https://doi.org/10.1002/ecm.1271.\n\n\nMaréchaux, Isabelle, Laurent Saint-André, Megan K. Bartlett, Lawren\nSack, and Jérôme Chave. 2019. “Leaf Drought Tolerance Cannot Be\nInferred from Classic Leaf Traits in a Tropical Rainforest.”\nEdited by Pierre Mariotte. Journal of Ecology 108 (3): 1030–45.\nhttps://doi.org/10.1111/1365-2745.13321.\n\n\nMuñoz-Sabater, Joaquín, Emanuel Dutra, Anna Agustí-Panareda, Clément\nAlbergel, Gabriele Arduini, Gianpaolo Balsamo, Souhail Boussetta, et al.\n2021. “ERA5-Land: A State-of-the-Art Global Reanalysis Dataset for\nLand Applications.” Earth System Science Data 13 (9):\n4349–83. https://doi.org/10.5194/essd-13-4349-2021.\n\n\nNemetschek, Daniela, Géraldine Derroire, Eric Marcon, Mélaine\nAubry-Kientz, Johanna Auer, Vincyane Badouard, Christopher Baraloto, et\nal. 2024. “Climate Anomalies and Neighbourhood Crowding Interact\nin Shaping Tree Growth in Old-Growth and Selectively Logged\nTropical Forests.” Journal of Ecology, January. https://doi.org/10.1111/1365-2745.14256.\n\n\nNepstad, D. C., P. Moutinho, M. B. Dias-Filho, E. Davidson, G. Cardinot,\nD. Markewitz, R. Figueiredo, et al. 2002. “The Effects of Partial\nThroughfall Exclusion on Canopy Processes, Aboveground Production, and\nBiogeochemistry of an Amazon Forest.” Journal of Geophysical\nResearch: Atmospheres 107 (D20). https://doi.org/10.1029/2001jd000360.\n\n\nPastorello, Gilberto, Trotta, Carlo, Canfora, Eleonora, Chu, Housen,\nChristianson, Danielle, Cheah, You-Wei, Poindexter, Cristina, et al.\n2020. “The FLUXNET2015 Dataset and the ONEFlux Processing Pipeline\nfor Eddy Covariance Data.” Nature Publishing Group. https://doi.org/10.5167/UZH-190509.\n\n\nQuesada, C. A., J. Lloyd, M. Schwarz, S. Patiño, T. R. Baker, C.\nCzimczik, N. M. Fyllas, et al. 2010. “Variations in Chemical and\nPhysical Properties of Amazon Forest Soils in Relation to Their\nGenesis.” Biogeosciences 7 (5): 1515–41. https://doi.org/10.5194/bg-7-1515-2010.\n\n\nSabatier, Daniel, Michel Grimaldi, Marie-Françoise Prévost, Julie\nGuillaume, Michel Godron, Mireille Dosso, and Daniel Sabatier. 1997.\n“The Influence of Soil Cover Organization on the Floristic and\nStructural Heterogeneity of a Guianan Rain Forest.” Plant\nEcology Formerly “Vegetatio” 131 (1): 81–108. https://doi.org/10.1023/a:1009775025850.\n\n\nSchmitt, Sylvain, and Marion Boisseaux. 2023. “Higher Local Intra-\nThan Interspecific Variability in Water- and Carbon-Related Leaf Traits\nAmong Neotropical Tree Species.” Annals of Botany 131\n(5): 801–11. https://doi.org/10.1093/aob/mcad042.\n\n\nSchmitt, Sylvain, Guillaume Salzet, Fabian Jörg Fischer, Isabelle\nMaréchaux, and Jerome Chave. 2023.\n“Rcontroll: An R Interface for the\nIndividual-Based Forest Dynamics Simulator\nTROLL.” Methods in Ecology and\nEvolution 14 (11): 2749–57. https://doi.org/10.1111/2041-210x.14215.\n\n\nSilver, Whendee L., Jason Neff, Megan McGroddy, Ed Veldkamp, Michael\nKeller, and Raimundo Cosme. 2000. “Effects of Soil Texture on\nBelowground Carbon and Nutrient Storage in a Lowland Amazonian Forest\nEcosystem.” Ecosystems 3 (2): 193–209. https://doi.org/10.1007/s100210000019.\n\n\nSmith, Marielle N., Scott C. Stark, Tyeen C. Taylor, Mauricio L.\nFerreira, Eronaldo de Oliveira, Natalia Restrepo-Coupe, Shuli Chen, et\nal. 2019. “Seasonal and Drought-Related Changes in\nLeaf Area Profiles Depend on Height and Light Environment in an Amazon\nForest.” New Phytologist 222 (3): 1284–97. https://doi.org/10.1111/nph.15726.\n\n\nUkkola, Anna M., Gab Abramowitz, and Martin G. De Kauwe. 2022. “A\nFlux Tower Dataset Tailored for Land Model Evaluation.” Earth\nSystem Science Data 14 (2): 449–61. https://doi.org/10.5194/essd-14-449-2022.\n\n\nVan Langenhove, Leandro, Thomas Depaepe, Lore T. Verryckt, Helena\nVallicrosa, Lucia Fuchslueger, Laynara F. Lugli, Laëtitia Bréchet, et\nal. 2021. “Impact of Nutrient Additions on\nFree-Living Nitrogen Fixation in Litter and Soil of Two\nFrench-Guianese Lowland Tropical Forests.”\nJournal of Geophysical Research: Biogeosciences 126 (7). https://doi.org/10.1029/2020jg006023.\n\n\nVleminckx, Jason, Claire Fortunel, Oscar Valverde-Barrantes, C. E.\nTimothy Paine, Julien Engel, Pascal Petronelli, Aurélie K. Dourdain,\nJuan Guevara, Solène Béroujon, and Christopher Baraloto. 2021.\n“Resolving Whole-Plant Economics from Leaf, Stem and\nRoot Traits of 1467 Amazonian Tree Species.” Oikos 130\n(7): 1193–1208. https://doi.org/10.1111/oik.08284."
  }
]